
{% comment %}

Do NOT change this file. It has been autogenerated by the Ordergroove Shopify App.
This file can be re-written at any time.
Last updated at: 2022-02-08T02:35:50.109Z / Version: 2.1.5

Please add the following code at the end of the <body> tag in layout/checkout.liquid.

{%- render 'ordergroove_checkout' -%}

{% endcomment %}

{%- render 'ordergroove_static_asset' -%}
<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./server/lib/theme-partials/js/checkout.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./server/lib/theme-partials/js/checkout.js":
/*!**************************************************!*\
  !*** ./server/lib/theme-partials/js/checkout.js ***!
  \**************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _helpers_ordergroove__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./helpers/ordergroove */ \"./server/lib/theme-partials/js/helpers/ordergroove.js\");\n/* harmony import */ var _helpers_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./helpers/storage */ \"./server/lib/theme-partials/js/helpers/storage.js\");\n/* harmony import */ var _helpers_cookies__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./helpers/cookies */ \"./server/lib/theme-partials/js/helpers/cookies.js\");\n\n\n\n\nconst injectCheckoutAttributes = element => {\n  const hasOptinsInput = document.querySelector(\"input[name='checkout[attributes][og_optins]']\");\n  const hasOfferIdsInput = document.querySelector(\"input[name='checkout[attributes][og_offer_ids]']\");\n  const optins = Object(_helpers_storage__WEBPACK_IMPORTED_MODULE_1__[\"getOptinsForProducts\"])(window.order_line_items);\n\n  if (!hasOptinsInput) {\n    Object(_helpers_ordergroove__WEBPACK_IMPORTED_MODULE_0__[\"injectInput\"])({\n      name: \"checkout[attributes][og_optins]\",\n      value: JSON.stringify(optins),\n      element\n    });\n  }\n\n  if (!hasOfferIdsInput) {\n    const ogState = JSON.parse(window.localStorage.getItem(\"OG_STATE\"));\n    const offerIds = ogState && JSON.stringify(ogState.productOffer);\n\n    if (offerIds) {\n      Object(_helpers_ordergroove__WEBPACK_IMPORTED_MODULE_0__[\"injectInput\"])({\n        name: \"checkout[attributes][og_offer_ids]\",\n        value: offerIds,\n        element\n      });\n    }\n  }\n};\n\nconst addConsentNotice = () => {\n  if (!document.querySelector(\"[data-payment-form] #consent-box-notice\")) {\n    const parent = document.querySelector(\"[data-payment-form] .checkbox__label\");\n    const notice = document.createElement(\"div\");\n    notice.classList.add(\"notice\", \"notice--error\", \"default-background\");\n    notice.id = \"consent-box-notice\";\n    const noticeText = document.createElement(\"p\");\n    noticeText.classList.add(\"notice__text\");\n    noticeText.innerHTML = window.ogShopifyConfigOSv1.settings.consentWarning ? decodeURI(window.ogShopifyConfigOSv1.settings.consentWarning) : \"To continue with your purchase, agree to the subscription terms\";\n    const noticeContent = document.createElement(\"div\");\n    noticeContent.classList.add(\"notice__content\");\n    noticeContent.appendChild(noticeText);\n    notice.appendChild(noticeContent);\n    parent.appendChild(notice);\n  }\n};\n\nconst removeConsentNotice = () => {\n  const notice = document.querySelector(\"[data-payment-form] #consent-box-notice\");\n\n  if (notice) {\n    notice.remove();\n  }\n};\n\nconst injectConsentAgreement = textContent => {\n  // Create consent agreement markup:\n  const consentAgreement = document.createElement(\"div\");\n  consentAgreement.classList.add(\"checkbox-wrapper\", \"section\");\n  const input = document.createElement(\"input\");\n  input.classList.add(\"input-checkbox\");\n  input.id = \"consent-box\";\n  input.type = \"checkbox\";\n  input.name = \"subscription-consent\";\n  input.value = \"subscription-consent\";\n  const inputWrapper = document.createElement(\"div\");\n  inputWrapper.classList.add(\"checkbox__input\");\n  inputWrapper.appendChild(input);\n  const label = document.createElement(\"label\");\n  label.innerHTML = textContent;\n  label.setAttribute(\"for\", \"consent-box\");\n  const labelWrapper = document.createElement(\"div\");\n  labelWrapper.classList.add(\"checkbox__label\");\n  labelWrapper.appendChild(label);\n  consentAgreement.appendChild(inputWrapper);\n  consentAgreement.appendChild(labelWrapper); // Add consent agreement to form:\n\n  const stepFooter = document.querySelector(\".main__content .step .step__footer\");\n  stepFooter.parentNode.insertBefore(consentAgreement, stepFooter);\n  input.addEventListener(\"change\", e => {\n    if (e.target.checked) {\n      removeConsentNotice();\n    } else {\n      addConsentNotice();\n    }\n  }); // Prevent form submission unless box is checked\n\n  document.querySelector('#continue_button[type=\"submit\"]').addEventListener(\"click\", e => {\n    if (!document.querySelector(\"#consent-box\").checked) {\n      e.preventDefault();\n      addConsentNotice();\n    } else {\n      removeConsentNotice();\n    }\n  });\n};\n\ndocument.addEventListener(\"page:load\", () => {\n  const {\n    customer\n  } = window.ogShopifyConfigOSv1;\n  const {\n    gateway,\n    shouldUseSafeAssets\n  } = window.ogShopifyConfigOSv1.settings;\n  const hasSubscriptions = Object(_helpers_storage__WEBPACK_IMPORTED_MODULE_1__[\"getAutoshipValue\"])();\n\n  if (customer) {\n    if (shouldUseSafeAssets) {\n      Object(_helpers_cookies__WEBPACK_IMPORTED_MODULE_2__[\"setOGAuthCookieSafe\"])(customer);\n    } else {\n      Object(_helpers_cookies__WEBPACK_IMPORTED_MODULE_2__[\"setOGAuthCookieUnSafe\"])(customer);\n    }\n  } else {\n    Object(_helpers_cookies__WEBPACK_IMPORTED_MODULE_2__[\"clearCookie\"])(\"og_auth\");\n  }\n\n  const autoShipValue = Object(_helpers_storage__WEBPACK_IMPORTED_MODULE_1__[\"getAutoshipValue\"])();\n  const alternativePayments = document.querySelector(\"[data-alternative-payments]\");\n\n  if (autoShipValue && alternativePayments) {\n    alternativePayments.style.display = \"none\";\n  }\n\n  if (hasSubscriptions && (gateway === \"authNet\" || gateway === \"cyberSource\") && Shopify.Checkout.step === \"payment_method\") {\n    const textContent = window.ogShopifyConfigOSv1.settings.consentText ? decodeURI(window.ogShopifyConfigOSv1.settings.consentText) : \"I understand that I'm agreeing to a subscription. It will renew at the price and frequency listed until it ends or is cancelled.\";\n    injectConsentAgreement(textContent);\n  }\n});\ndocument.addEventListener(\"page:load\", () => {\n  injectCheckoutAttributes(document.querySelector(\".main__content .step form\"));\n});\ndocument.addEventListener(\"page:change\", () => {\n  injectCheckoutAttributes(document.querySelector(\".main__content .step form\"));\n});\n\n//# sourceURL=webpack:///./server/lib/theme-partials/js/checkout.js?");

/***/ }),

/***/ "./server/lib/theme-partials/js/helpers/cookies.js":
/*!*********************************************************!*\
  !*** ./server/lib/theme-partials/js/helpers/cookies.js ***!
  \*********************************************************/
/*! exports provided: getCookieValue, clearCookie, makeOGAuthRequest, setOGAuthCookieSafe, setOGAuthCookieUnSafe */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCookieValue\", function() { return getCookieValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearCookie\", function() { return clearCookie; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"makeOGAuthRequest\", function() { return makeOGAuthRequest; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setOGAuthCookieSafe\", function() { return setOGAuthCookieSafe; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setOGAuthCookieUnSafe\", function() { return setOGAuthCookieUnSafe; });\n/*\n  Helper function to get the value of a cookie by id\n*/\nconst getCookieValue = cookieId => {\n  const cookie = document.cookie.match(`(^|;) ?${cookieId}=([^;]*)(;|$)`);\n  return cookie ? cookie[2] : null;\n};\n/*\n  Helper function to clear a cookie by id.\n  Setting a past date on a cookie makes it invalid\n*/\n\nconst clearCookie = cookieId => {\n  // clear existing OG auth cookie\n  document.cookie = `${cookieId}=; expires=Thu, 01 Jan 1970 00:00:01 GMT;`;\n};\nconst makeOGAuthRequest = async customer => {\n  let auth = {};\n\n  try {\n    const response = await fetch(`/apps/subscriptions/auth/?customer=${customer.id}&customer_signature=${customer.signature}&customer_timestamp=${customer.timestamp}`, {\n      credentials: \"same-origin\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-Requested-With\": \"xmlhttprequest\"\n        /* XMLHttpRequest is ok too, it's case insensitive */\n\n      },\n      method: \"GET\"\n    });\n    const data = await response.text();\n    const anchorPrefix = \"og_auth_\";\n    const beginAnchor = `${anchorPrefix}begin`;\n    const endAnchor = `${anchorPrefix}end`;\n    const beginningIndex = data.lastIndexOf(beginAnchor);\n\n    if (beginningIndex < 0) {\n      throw \"Invalid response from OG auth endpoint\";\n    }\n\n    auth = JSON.parse(data.substring(beginningIndex + beginAnchor.length, data.lastIndexOf(endAnchor)));\n  } catch (err) {\n    console.error(err);\n  }\n\n  return auth;\n};\nconst setOGAuthCookieSafe = async customer => {\n  const ogAuthCookie = getCookieValue(\"og_auth\"); // The cookie hasn't expired yet so we don't need to refresh the auth\n\n  if (ogAuthCookie) {\n    return;\n  }\n\n  const {\n    customerId,\n    timestamp,\n    signature\n  } = await makeOGAuthRequest(customer);\n\n  if (!customerId) {\n    return;\n  } // set expiration to now + 2hrs\n\n\n  const ogToday = new Date();\n  const binarySignature = btoa(signature);\n  ogToday.setTime(ogToday.getTime() + 2 * 60 * 60 * 1000);\n  document.cookie = `og_auth=${customerId}|${timestamp}|${binarySignature};expires=${ogToday.toUTCString()};secure;path=/`;\n};\nconst setOGAuthCookieUnSafe = customer => {\n  const signature = customer.signature;\n  const ogToday = new Date();\n  const binarySignature = btoa(signature); // set expiration to now + 2hrs\n\n  ogToday.setTime(ogToday.getTime() + 2 * 60 * 60 * 1000);\n  document.cookie = `og_auth=${customer.id}|${customer.timestamp}|${binarySignature};expires=${ogToday.toUTCString()};secure;path=/`;\n};\n\n//# sourceURL=webpack:///./server/lib/theme-partials/js/helpers/cookies.js?");

/***/ }),

/***/ "./server/lib/theme-partials/js/helpers/ordergroove.js":
/*!*************************************************************!*\
  !*** ./server/lib/theme-partials/js/helpers/ordergroove.js ***!
  \*************************************************************/
/*! exports provided: lineItemKey, localStorageKey, injectInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lineItemKey\", function() { return lineItemKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"localStorageKey\", function() { return localStorageKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"injectInput\", function() { return injectInput; });\nconst lineItemKey = \"og_subscription\";\nconst localStorageKey = \"OG_STATE\";\n/*\n  Helper function to inject a hidden input append to an element\n\n  Mainly used to inject cookies as input. Defaults as hidden input type\n*/\n\nconst injectInput = ({\n  name,\n  value,\n  element,\n  inputType\n}) => {\n  const input = document.createElement(\"input\");\n  input.type = inputType ? inputType : \"hidden\";\n  input.name = name;\n  input.value = value;\n  element.appendChild(input);\n};\n\n//# sourceURL=webpack:///./server/lib/theme-partials/js/helpers/ordergroove.js?");

/***/ }),

/***/ "./server/lib/theme-partials/js/helpers/storage.js":
/*!*********************************************************!*\
  !*** ./server/lib/theme-partials/js/helpers/storage.js ***!
  \*********************************************************/
/*! exports provided: getAutoshipValue, getOptins, getOptinsForProducts */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAutoshipValue\", function() { return getAutoshipValue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getOptins\", function() { return getOptins; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getOptinsForProducts\", function() { return getOptinsForProducts; });\n/* harmony import */ var _ordergroove__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ordergroove */ \"./server/lib/theme-partials/js/helpers/ordergroove.js\");\n\n\nconst getOGState = () => {\n  const data = _ordergroove__WEBPACK_IMPORTED_MODULE_0__[\"localStorageKey\"] && JSON.parse(localStorage.getItem(_ordergroove__WEBPACK_IMPORTED_MODULE_0__[\"localStorageKey\"]));\n  return data;\n};\n\nconst getAutoshipValue = () => {\n  const optins = getOptinsForProducts(window.order_line_items);\n  return optins.length > 0;\n};\nconst getOptins = () => {\n  if (typeof OG === \"undefined\" || typeof OG.getOptins !== \"function\") {\n    console.warn(\"OG or OG.getOptins does not exist!\");\n    return [];\n  }\n\n  return OG.getOptins();\n};\nconst getOptinsForProducts = optins => {\n  if (typeof OG === \"undefined\" || typeof OG.getOptins !== \"function\") {\n    console.warn(\"OG or OG.getOptins does not exist!\");\n    return [];\n  }\n\n  return OG.getOptins(optins);\n};\n\n//# sourceURL=webpack:///./server/lib/theme-partials/js/helpers/storage.js?");

/***/ })

/******/ });</script>

<script>
  if (Shopify.Checkout.page === "thank_you") {
    window.og_settings = {
      page_type: "4"
    }
    window.addEventListener("load", () => {
      OG.clear();
    });
  }
  
</script>

<script>
  var productIds = [];
  {% for item in checkout.line_items %}
  productIds.push("{{item.variant_id}}");
  {% endfor %}
  window.order_line_items = productIds;

  const element = document.querySelector(".main__content .step form");
  {% for attribute in checkout.attributes %}
  if("{{ attribute.first }}" !== "og_optins" && "{{ attribute.first }}" !== "og_offer_ids"){
    var input = document.createElement("input");
    input.type = "hidden";
    input.name = "checkout[attributes][{{ attribute.first }}]";
    input.value = "{{ attribute.last  }}";
    element.appendChild(input);
  }
  {% endfor %}
</script>
